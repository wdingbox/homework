<!DOCTYPE html>
<html>
	<head>
		<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
		<meta content="width=device-width, initial-scale=1" name="viewport" />
		<meta content="en-us" http-equiv="Content-Language" />
		<title>PersonsNT</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script><script src="http://maps.googleapis.com/maps/api/js"></script>
		<style type="text/css">
.text_container{
            height:600px;
            width:100%;
            background-color:#eeeeee;
            border-style: solid;
            border-width: 2px;
            overflow:scroll;
        }
        
        .tdclked{
           background-color:#cccccc;
        }
        table:nth-child(1){
            background-color:#ffeedd;
        }
        table:nth-child(2){
            background-color:#eeeeff;
        }
        
        .clickedcircle2td{
            background-color:#00cccc;
        }		
        .JMentioned{
            border: 2px solid #ff0000;
        }	


#psersonNames tbody tr td:nth-child(11){
background: #7777ff;
}	
#psersonNames tbody tr td:nth-child(12){
background: #ff7777;
}		
#zz{}		</style>
		<script>

  $(document).ready(function(){ 
    runTable();
    duplicateNamesCheck();
    ColMaxMarker();
  });//doc
function runTable(){
    $("#psersonNames tbody tr").each(function(i){
        console.log(i);
        if(i>1){
            totalCalc(this,i);
            personHighlite(this,i);
        }
    });
}  
function totalCalc(tr, i){
            $(tr).find("td:eq(0)").text(i-1);
            
            var totB=totalCount($(tr),2,8, "#aaaaff");
            $(tr).find("td:eq("+10+")").text(totB);
            
            var totJ=totalCount($(tr),3,9, "#ffbbbb");
            $(tr).find("td:eq("+11+")").text(totJ);
}
function personHighlite(tr, i){
            var totJ=$(tr).find("td:eq("+11+")").text();
            var iJ=parseInt(totJ);
            if(iJ>0){
                $(tr).find("td:eq("+1+")").addClass('JMentioned');
            }
}
function duplicateNamesCheck(){
    var namesArr=[];
    $("#psersonNames tbody tr").each(function(i){
        if(i>1){
            var name=$.trim($(this).find("td:eq("+1+")").text());
            if(name.length>0){
                if(namesArr.indexOf(name)>0){
                    $(this).css("background-color","red").remove();
                }
                else{
                    namesArr.push(name);
                }            
            }

        }
    });
}
function ColMaxMarker(){
    for(var i=2;i<=11;i++){
        ColMaxMark(i);
    }
}

function ColMaxMark(iCol){
    var Max=-1, cell=null;
    $("#psersonNames tbody tr").each(function(i){
        if(i>1){
            var td=$(this).find("td:eq("+iCol+")");
            var txt=$.trim($(td).text());
            if(txt.length>0 && txt!='-'){
                var val=parseInt(txt);
                if( val > Max){
                    Max = val;
                    cell=td;                    
                }         
            }
        }
    });
    $(cell).css("color","red");
}
function totalCount(tr, ciStart,ciEnd, colr){
    var totB=0;
    for(var ci=ciStart;ci<=ciEnd;ci+=2){
        var sb=$(tr).find("td:eq("+ci+")").css("background-color",colr).text();
        sb=$.trim(sb);
        if(sb.length==0) continue;
        if(sb==='-') continue;
        if(true==isNaN(sb)) continue;
        var nb=parseInt(sb);
        if( false==isNaN(sb) ) {
            totB +=nb ;
        }
    }
    return totB;
}

        </script>
	</head>
	<body>
		<table border="1" cellpadding="1" cellspacing="1" id="psersonNames" style="width: 500px">
			<caption>
				12 Apostles_NT</caption>
			<tbody>
				<tr>
					<th colspan="1" rowspan="2">
						#</th>
					<th colspan="1" rowspan="2">
						Names</th>
					<th colspan="2" rowspan="1" style="text-align: center;">
						Mathew</th>
					<th colspan="2" rowspan="1" style="text-align: center;">
						Mark</th>
					<th colspan="2" rowspan="1" style="text-align: center;">
						Luke</th>
					<th colspan="2" rowspan="1" style="text-align: center;">
						John</th>
					<th colspan="2" rowspan="1" style="text-align: center;">
						Total</th>
					<th colspan="1" rowspan="2" style="text-align: center;">
						&nbsp;</th>
				</tr>
				<tr>
					<th style="text-align: center;">
						B</th>
					<th style="text-align: center;">
						J</th>
					<th style="text-align: center;">
						B</th>
					<th style="text-align: center;">
						J</th>
					<th style="text-align: center;">
						B</th>
					<th style="text-align: center;">
						J</th>
					<th style="text-align: center;">
						B</th>
					<th style="text-align: center;">
						J</th>
					<th style="text-align: center;">
						B</th>
					<th style="text-align: center;">
						J</th>
				</tr>
				<tr>
					<td>
						&nbsp;</td>
					<td>
						奋锐党的西门</td>
					<td>
						1</td>
					<td>
						0</td>
					<td>
						1</td>
					<td>
						0</td>
					<td>
						1</td>
					<td>
						0</td>
					<td>
						0</td>
					<td>
						0</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						又稱迦南人西門</td>
				</tr>
				<tr>
					<td>
						&nbsp;</td>
					<td>
						施洗约翰</td>
					<td>
						28</td>
					<td>
						9</td>
					<td>
						20</td>
					<td>
						1</td>
					<td>
						28</td>
					<td>
						6</td>
					<td>
						23</td>
					<td>
						3</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
				</tr>
				<tr>
					<td>
						&nbsp;</td>
					<td>
						约翰</td>
					<td>
						3</td>
					<td>
						0</td>
					<td>
						6</td>
					<td>
						0</td>
					<td>
						4</td>
					<td>
						0</td>
					<td>
						0</td>
					<td>
						0</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						西庇太的儿子. 雅各的兄弟 耶穌為他們起名為「半尼其」（Boanerges），意為「雷子」</td>
				</tr>
				<tr>
					<td>
						&nbsp;</td>
					<td>
						约翰father</td>
					<td>
						28</td>
					<td>
						2</td>
					<td>
						23</td>
					<td>
						1</td>
					<td>
						21</td>
					<td>
						1</td>
					<td>
						34</td>
					<td>
						3</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						约翰的儿子西门彼得</td>
				</tr>
				<tr>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
				</tr>
				<tr>
					<td>
						&nbsp;</td>
					<td>
						父親雅各</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						父親雅各（路六：16；徒一：13）；</td>
				</tr>
				<tr>
					<td>
						&nbsp;</td>
					<td>
						雅各</td>
					<td>
						3</td>
					<td>
						0</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						西庇太的儿子雅各</td>
				</tr>
				<tr>
					<td>
						&nbsp;</td>
					<td>
						小雅各</td>
					<td>
						1</td>
					<td>
						0</td>
					<td>
						2</td>
					<td>
						0</td>
					<td>
						1</td>
					<td>
						0</td>
					<td>
						0</td>
					<td>
						0</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						亚勒腓的儿子雅各 =小雅各第一位耶路撒冷主教<br />
						AD 62. James</td>
				</tr>
				<tr>
					<td>
						&nbsp;</td>
					<td>
						雅各2</td>
					<td>
						0</td>
					<td>
						0</td>
					<td>
						1</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						&nbsp;</td>
					<td>
						马利亚的儿子、雅各</td>
				</tr>
			</tbody>
		</table>
		<p>
			&nbsp;</p>
	</body>
</html>
